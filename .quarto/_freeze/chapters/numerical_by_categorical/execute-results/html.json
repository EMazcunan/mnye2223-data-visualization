{
  "hash": "22b6dc614245097e9809a5ece5437059",
  "result": {
    "markdown": "---\neditor:\n    render-on-save: true\n---\n\n# Una variable numérica por categorías\n\n\nEn la @sec-1numerical estudiamos la distribución del peso de todos los pingüinos del estudio. Ahora estudiaremos si hay diferencias en la distribución del peso dependiendo de la especie.\n\n## El método `describe()` \n\n\nEl método `describe()` que usamos en la @sec-1numerical-describe para obtener un resumen de la distribución del peso de todos los pingüinos, también puede aplicarse al peso agrupado por especies:\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\npenguins.groupby(\"species\")[\"body_mass_g\"].describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n      <th>mean</th>\n      <th>std</th>\n      <th>min</th>\n      <th>25%</th>\n      <th>50%</th>\n      <th>75%</th>\n      <th>max</th>\n    </tr>\n    <tr>\n      <th>species</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Adelie</th>\n      <td>151.0</td>\n      <td>3700.662252</td>\n      <td>458.566126</td>\n      <td>2850.0</td>\n      <td>3350.0</td>\n      <td>3700.0</td>\n      <td>4000.0</td>\n      <td>4775.0</td>\n    </tr>\n    <tr>\n      <th>Chinstrap</th>\n      <td>68.0</td>\n      <td>3733.088235</td>\n      <td>384.335081</td>\n      <td>2700.0</td>\n      <td>3487.5</td>\n      <td>3700.0</td>\n      <td>3950.0</td>\n      <td>4800.0</td>\n    </tr>\n    <tr>\n      <th>Gentoo</th>\n      <td>123.0</td>\n      <td>5076.016260</td>\n      <td>504.116237</td>\n      <td>3950.0</td>\n      <td>4700.0</td>\n      <td>5000.0</td>\n      <td>5500.0</td>\n      <td>6300.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nVemos que obtenemos una tabla con el resultado combinado de aplicar el método `describe()` en el grupo de datos correspondiente a cada una de las tres especies.\n\nInterpretamos los resultados en las columnas de rótulo `count`, `mean`, `50%` y `max`:\n\n\nFragmento de la salida | Significado\n----- | ------\n`count` | De la @sec-1categorical-describe sabíamos que hay $152$ pingüinos de la especie Adelie, $124$ de la especie Gentoo, y $68$ de la especie Chinstrap. Y de la @sec-1numerical-describe sabíamos que se desconoce el peso de dos pingüinos. Ahora sabemos que esos dos pingüinos son uno de la especie Adelie y otro de la especie Gentoo, y que se conoce el peso de todos los pingüinos de la especie Chinstrap.\n`mean` | El peso medio de los pingüinos de la especie Gentoo es de $5$ kilogramos y $76$ gramos, superior a la media global de $4$ kilos y $201$ gramos (que conocíamos de la @sec-1numerical-describe). Y los pesos medios de las especies Adelie y  Chinstrap son inferiores a la media global y muy similares: $3$ kilos $700$ gramos, y $3$ kilos y $733$ gramos respectivamente.\n`50%` | La mediana del peso es la misma para las especies Adelie y Chinstrap, $3$ kilos y $700$ gramos, y sustancialmente más grande, $5$ kilos para la especie Gentoo.\n`max` | El pingüino de mayor peso del estudio, con $6$ kilos y $300$ gramos, es de la especie Gentoo. Mientras que el peso máximo para las especies Adelie y Chinstrap no supera los $5$ kilos ($4$ kilos y $775$ gramos y $4$ kilos y $800$ gramos respectivamente).\n\n::: {#exr-numerical_by_categorical-describe}\nUsa los métodos `groupby()` y `describe()` para responder a las siguientes preguntas:\n\na.  Indica el peso medio de hembras y machos y compáralos con el peso medio global.\na.  ¿Cuál es el peso máximo de las hembras?\na.  ¿Cuál es la mediana del peso de los machos?\na.  El pingüino de mayor peso ¿es macho o hembra?\n:::\n\n\n## Histogramas \n\nEn este apartado aprenderemos a construir diferentes histogramas para comparar la distribución del peso de las tres especies de pingüinos.\n\n### Histograma de barras apiladas\n\nPara crear un histograma del peso distinguiendo la especie mediante barras apiladas ejecuta la siguiente instrucción:\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nsns.histplot(\n    data=penguins, \n    x=\"body_mass_g\", \n    hue=\"species\",\n    multiple=\"stack\"\n);\n```\n\n::: {.cell-output .cell-output-display}\n![](numerical_by_categorical_files/figure-html/cell-4-output-1.png){width=585 height=429}\n:::\n:::\n\n\nObserva que la forma del diagrama es la misma que la del histograma que se realizó en la @sec-1numerical-histogram. La novedad es que cada una de las barras que representa el número de pingüinos en cada uno de los intervalos de peso se ha fragmentado en tres barras indicando la contribución de cada especie. Aprecia que conforme va aumentando el peso, va disminuyendo la contribución de las especies Adelie (azul) y Chinstrap (naranja), y aumentando la contribución de la especie Gentoo (verde).\n\nCon el argumento `hue=\"species\"` conseguimos que los datos se dividan según las categorías de la variable `species` y se asigne un color diferente a cada categoría, que se indica en la leyenda de la esquina superior derecha del gráfico.  \n\nY con el argumento `multiple=\"stack\"` indicamos que las barras de cada especie se dibujen apiladas en cada intervalo.\n\n::: {.callout-note}\nPara crear un histograma de barras apiladas de una variable numérica por categorías, usa la función `histplot()` del paquete `seaborn` conforme aprendiste en la sección @sec-1numerical-histogram y además:\n\n- indica el nombre de la variable que determina las categorías como valor del parámetro `hue`.\n- usa `multiple=\"stack\"` para que las barras de las diferentes categorías se muestren apiladas.\n::: \n\n\n::: {#exr-histogram-stack}\nCrea un histograma de barras apiladas para el peso de los pingüinos por sexo.\n:::\n\n### Histograma de barras separadas\n\nPara crear un histograma del peso con barras separadas para cada especie ejecuta la siguiente instrucción:\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\nsns.histplot(\n    data=penguins,  \n    x=\"body_mass_g\", \n    hue=\"species\",\n    multiple=\"dodge\"\n);\n```\n\n::: {.cell-output .cell-output-display}\n![](numerical_by_categorical_files/figure-html/cell-5-output-1.png){width=585 height=429}\n:::\n:::\n\n\nEn este tipo de histograma fijándonos en las barras de un solo color vemos el histograma de la especie correspondiente. \n\n::: {.callout-note}\nPara crear un histograma de barras separadas procede de la misma forma que para crear un histograma de barras apiladas pero cambia el valor del parámetro `multiple` a `\"dodge\"`.\n::: \n\n::: {#exr-histogram-stack}\nCrea un histograma de barras separadas para la longitud del pico de los pingüinos por sexo.\n:::\n\n<!-- ```{python}\nsns.histplot(data=penguins,  x=\"body_mass_g\", hue=\"species\",\n    # stat=\"count\",\n    multiple=\"layer\"\n);\n``` -->\n\n<!-- ```{python}\nsns.histplot(data=penguins, x=\"body_mass_g\", hue=\"species\",\n    # stat=\"count\",\n    multiple=\"fill\"\n);\n``` -->\n\n\n### Mosaico de histogramas\n\nEn los dos apartados anteriores aprendiste a crear dos tipos de histogramas para visualizar la distribución de una variable numérica distinguiendo varias categorías con colores diferentes en un mismo gráfico. Pero a veces puede resultar más útil realizar histogramas independientes para cada categoría. En este apartado aprenderás a crear, de forma simultánea, tres histogramas con la distribución del peso de los pingüinos de cada especie.  \n\n\nCon este fin el paquete `seaborn` proporciona la clase `FacetGrid`, que permite crear un mosaico o una malla en la que ubicar los diferentes gráficos para los datos de cada categoría. \n\n\nPara entender cómo se usa la clase `FacetGrid` empieza ejecutando la siguiente instrucción:\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\nsns.FacetGrid(data=penguins, col=\"species\")\n```\n\n::: {.cell-output .cell-output-display}\n![](numerical_by_categorical_files/figure-html/cell-6-output-1.png){width=850 height=276}\n:::\n:::\n\n\nObserva el resultado y aprecia que se han creado tres ejes de coordenadas, uno para cada especie. El efecto del argumento `col=\"species\"` es que se ha creado una columna (`col`=_column_) para cada categoría de la variable `species`. \n\nDe momento hemos inicializado el mosaico pero aún no hemos dibujado nada en cada una de las celdas del mosaico. Para hacerlo tenemos que aplicar al mosaico el método `map()`, como en el siguiente ejemplo:\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\ngrid = sns.FacetGrid(data = penguins, col=\"species\")\ngrid.map(sns.histplot, \"body_mass_g\");\n```\n\n::: {.cell-output .cell-output-display}\n![](numerical_by_categorical_files/figure-html/cell-7-output-1.png){width=853 height=275}\n:::\n:::\n\n\n::: {.callout-important}\nPara que puedas visualizar el gráfico anterior en tu cuaderno de _Colab_ tienes que escribir las dos instrucciones anteriores en la misma celda. \n:::\n\nFíjate en las dos etapas que se han seguido en el ejemplo anterior para la construcción de los tres histogramas:\n\n1. La primera instrucción \n\n   `grid = sns.FacetGrid(data = penguins, col=\"species\")`{.python}\n\n   crea el mosaico con las tres columnas para las tres especies, y lo almacena en un nuevo objeto de nombre `grid` (puedes usar cualquier otro nombre). \n\n   ::: {.callout-note}\n   Para inicializar un mosaico de gráficos con una columna para cada valor de una variable    categórica, inicializa la clase `FacetGrid` indicando:\n   \n   - La hoja de datos como valor del parámetro `data`\n   - El nombre de la variable categórica para crear los grupos como valor del parámetro `col`\n   :::\n\n   En este punto tenemos preparadas tres celdas para crear en cada celda un gráfico de los datos de la especie correspondiente a esa celda. La creación efectiva de los gráficos se realiza en el siguiente paso. \n\n2. La segunda instrucción \n\n   `grid.map(sns.histplot, \"body_mass_g\")`{.python}  \n\n   aplica el método `map()` al mosaico creado en el paso anterior, especificando qué tipo de gráfico queremos en cada celda del mosaico, y a qué variable queremos aplicar ese gráfico:\n\n   - El primer argumento `sns.histplot` indica que en cada celda queremos realizar un histograma (para el grupo de datos de la especie correspondiente a la celda).\n   - El segundo argumento `\"body_mass_g\"` indica la variable de la que queremos hacer los histogramas.\n\n   ::: {.callout-note}\n   Para crear sendos gráficos de los datos asociados a cada celda de un mosaico creado con `FacetGrid` usa el método `map()` con los siguientes argumentos:\n\n   - La función para construir los gráficos\n   - El nombre de la variable a la que aplicar esa función gráfica\n   :::\n\n\n\n:::: {#exr-facetgrid}\nUsa la clase `FacetGrid` para realizar sendos histogramas de la distribución del peso para hembras y machos.\n\n::: {.content-visible when-format=\"html\"}\n\nTienes que obtener la siguiente salida:\n\n::: {.cell execution_count=7}\n\n::: {.cell-output .cell-output-display}\n![](numerical_by_categorical_files/figure-html/cell-8-output-1.png){width=565 height=275 fig-env='center'}\n:::\n:::\n\n\n:::\n\n::::\n\n\n***\n\nSi al inicializar la clase `FacetGrid` se usa el parámetro `row` en lugar de `col` los diferentes gráficos aparecerán dispuestos por filas en lugar de por columnas. Por ejemplo:\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\ngrid = sns.FacetGrid(data = penguins, row=\"species\")\ngrid.map(sns.histplot, \"body_mass_g\");\n```\n\n::: {.cell-output .cell-output-display}\n![](numerical_by_categorical_files/figure-html/cell-9-output-1.png){width=277 height=851}\n:::\n:::\n\n\nDe hecho, se pueden usar los argumentos `row` y `col` al mismo tiempo para crear un mosaico bidimensional. Las siguientes instrucciones crean un mosaico de histogramas del peso de los pingüinos, distinguiendo la especie por filas y el sexo por columnas, de dimensiones $3 \\times 2$:\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\ngrid = sns.FacetGrid(data = penguins, row=\"sex\", col=\"species\")\ngrid.map(sns.histplot, \"body_mass_g\");\n```\n\n::: {.cell-output .cell-output-display}\n![](numerical_by_categorical_files/figure-html/cell-10-output-1.png){width=853 height=563}\n:::\n:::\n\n\n:::: {#exr-FacetGrid-3x2}\nUsa `FacetGrid` para crear un mosaico de histogramas para la longitud de las alas de los pingüinos distingüiendo la isla en la que viven y su sexo.\n\n::: {.content-visible when-format=\"html\"}\nEl resultado debe ser el siguiente:\n\n::: {.cell execution_count=10}\n\n::: {.cell-output .cell-output-display}\n![](numerical_by_categorical_files/figure-html/cell-11-output-1.png){width=565 height=851 fig-env='center'}\n:::\n:::\n\n\n:::\n::::\n\n\n## Diagramas de caja y bigotes\n\nPara acabar la práctica realizaremos el gráfico de la portada de este documento\n![](../img/cover/cover.png)\nen el que se representa un diagrama de caja y bigotes para el peso de los pingüinos de cada especie. \n\nEn la @sec-1numerical-boxplot hicimos un diagrama de caja y bigotes para el peso de todos los pingüinos (sin distinguir la especie) con la instrucción\n\n```{.python}\nsns.boxplot(data=penguins, y=\"body_mass_g\");\n```\n\nPara diferenciar por especie no tenemos más que añadir el argumento `x=\"species\"`:\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\nsns.boxplot(data=penguins, x=\"species\", y=\"body_mass_g\");\n```\n\n::: {.cell-output .cell-output-display}\n![](numerical_by_categorical_files/figure-html/cell-12-output-1.png){width=602 height=429}\n:::\n:::\n\n\nLos dos puntos que aparecen resaltados con un rombo fuera de los bigotes en el diagrama de la especie Chinstrap (en naranja) son  __outliers__. El outlier por debajo del bigote inferior representa un pingüino de la especie Chinstrap con peso excesivamente bajo, y el outlier por encima del bigote superior se corresponde con un pingüino de la especie Chinstrap con peso excesivamente alto (excesivamente bajo/alto respecto a la distribución del peso en los pingüinos de la especie Chinstrap).\n\n\n::: {#exr-boxplots}\nRealiza un gráfico que muestre los diagramas de caja y bigotes para el peso de las hembras y de los machos.\n\n¿Aparecen outliers en alguno de los dos grupos?\n:::\n\n",
    "supporting": [
      "numerical_by_categorical_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}